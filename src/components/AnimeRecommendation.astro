---
const { animeRecommendation } = Astro.props;
const { title, images, mal_id } = animeRecommendation;
---

<div class="animeRecommendation">
  <h1 class="text-center">{title}</h1>
  <a href="#" id="moreInfoLink" data-mal-id={mal_id}>
    {
      images && images.jpg && (
        <img src={images.jpg.image_url} alt="Anime Image" class="size-auto" />
      )
    }
  </a>
</div>

<script>
  
  function showInformation(animeID: string) {
    fetch(`https://api.jikan.moe/v4/anime/${animeID}/moreinfo`)
      .then((response) => response.json())
      .then((data) => {
        console.log(data);
      })
      .catch((error) => {
        console.error("Error fetching anime information:", error);
      });
  }

  const moreInfoLink = document.querySelectorAll("#moreInfoLink");
  if (moreInfoLink) {
    moreInfoLink.forEach((link) => {
        link.addEventListener("click", function (event) {
            event.preventDefault(); // Prevent default behavior of anchor tag
            const animeId = link.getAttribute("data-mal-id");
            console.log("Clicked on more info link" + animeId);
            if (animeId) {
                showInformation(animeId);
            }
        });
    });      
  }
</script>
